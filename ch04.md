# 4장 변수

## 4.1 변수(variable)란 무엇인가? 왜 필요한가?

컴퓨터는 CPU를 사용해 연산하고 메모리를 사용해 데이터를 기억한다.

메모리는 데이터를 저장할 수 있는 메모리 셀의 잡합체다. 메모리 셀 하나의 크기는 1 byte(8 bit)이고, 컴퓨터는 메모리 셀 크기(= 1 byte) 단위로 데이터를 저장하고 읽는다. 각 셀은 고유의 메모리 주소를 갖는다.

예를 들어 10+20이라는 연산을 할 때, 10과 20이 임의의 메모리주소에 각각 저장되고 그 결과값 30도 임의의 메모리주소에 저장된다. 그런데 이 결과값을 재사용하려면 메모리 주소를 통해 직접 접근해야 되는데 잘못하면 치명적인 오류를 발생시킬 수 있다. 

자바스크립트는 개발자가 직접적인 메모리 제어를 할 수 없다. 만약에 할 수 있어도 값이 저장되는 메모리 주소는 코드를 실행할 때마다 달라지기 때문에 코드 실행 전에 값이 저잘된 메모리 주소를 알 수가 없다.

그래서 사용하는게 변수이다. **변수**는 값을 저장할 메모리 공간의 위치를 가리키는 이름이다.

> 변수는 하나의 값을 저장하는 메커니즘이다. 만약에 여러 개의 값을 저장하고 싶으면 배열이나 객체 같은 자료구조를 사용해서 여러값을 그룹화해서 하나의 값처럼 만들어 저장해야 한다.

변수에 값을 저장하는 것을 **할당**이라고 하고 저장된 값을 읽어오는 것을 **참조**라고 한다.

### 실제 메모리가 변수에 저장되는 방식

```js
const result = 10 + 20;
```

![실제 메모리에 변수가 저장되는 방식](https://images.velog.io/images/inhalin/post/10366a5b-0493-4b88-a563-39fbcb9984f6/variable_memory.png)

## 4.2 식별자(identifier)

식별자(=변수 이름)는 값이 아닌 메모리 주소를 기억하고 있다. 즉, 위에 그림에서 `result`가 기억하는 값은 30이 아니라 30이 저장되어 있는 메모리주소인 `0x0045F678`이다.

식별자는 메모리 상에 존재하는 어떤 값을 식별할 수 있는 이름이다. 따라서 변수 외에도 함수. 클래스 등의 이름도 다 식별자이다.

## 4.3 변수 선언(variable declaration)

> 변수 선언 = 변수를 생성하는 것

변수를 사용하려면 반드시 선언을 먼저 해야 한다. 선언하지 않은 식별자에 접근하면 ReferenceError가 발생한다.

변수 선언 키워드는 `var`, `let`, `const`가 있다. (참고로 `let`, `const`는 13장 스코프부터 살펴본다.)


### var 키워드

var 키워드는 값을 할당하지 않고 변수만 선언하면 암목적으로 undefined라는 값이 할당되어 초기화된다.

```js
var salary;   // 선언 단계, undefined로 초기화

let plan;   // 선언 단계 : 아직 값이 없는 상태
plan = "Study JavaScript";  // 초기화 단계 : 값을 할당해줌
```

> 모든 식별자는 실행 컨텍스트(execution context)에 등록된다. 실행 컨텍스트는 자바스크립트 엔진이 소스코드를 평가하고 실행하기 위해 필요한 환경을 제공하고 코드의 실행 결과를 실제로 관리하는 영역이다. 자바스크립트 엔진은 실행 컨텍스트를 통해 식별자와 스코프를 관리한다.

## 4.4 변수 선언의 실행 시점과 변수 호이스팅(hoisting)

변수 호이스팅(variable hoisting)은 변수 선언문이 소스코드 맨 위로 끌어올려진 것처럼 동작하는 자바스크립트의 특징이다.

자바스크립트 엔진은 런타임 전에 먼저 소스코드의 평가과정을 거치는데 이때 소스코드에 있는 모든 선언문을 찾아서 먼저 실행한다. 그리고나서 나머지 소스코드를 순차적으로 실행한다. 따라서 변수가 선언된 위치와 상관없이 어디서든지 변수를 참조할 수 있다.

```js
console.log(hoihoi);    // undefined
sayHi();    // Hello World!

var sayHi = function(){
    console.log("Hello World!");
}
var hoihoi;
```

## 4.5 값의 할당(assignment)

변수 선언은 런타임 전에 먼저 실행되지만 값의 할당은 런타임에 실행된다.

변수 선언과 값 할당을 한번에 해도 먼저 변수에 undefined가 할당되어 초기화 되고 나서 값이 할당된다.

변수에 값을 할당할 때는 이전 값이 저장된 메모리 공간을 지우고 값을 할당하는 게 아니라 새로운 메모리 공간을 확보하고 그곳에 값을 할당하는 것이다. 즉 변수가 가리키는 메모리 주소가 변하게 된다.

![값의 할당과 재할당, 메모리 주소 변화](https://images.velog.io/images/inhalin/post/0cbb452a-b342-4326-8a32-decc0d4ba8ef/variable_decl_assign.png)

## 4.6 값의 재할당

재할당은 변수에 저장된 값을 다른 값으로 변경하는 것이다.

> `const`는 상수값을 저장하기 위한 키워드다. 즉, 변수값 재할당을 금지한다. 변수 선언과 동시에 값을 할당해줘야 한다.
> 
> 하지만 반드시 상수만을 위해 사용하지 않는다. 자세한 내용은 15장에 나옴.

> **가비지 콜렉터**는 더이상 사용되지 않는 메모리를 해제해서 메모리 누수를 방지하는 기능을 말한다. 4.5의 그림에서 `undefined`와 `-3.59`가 저장된 메모리 공간은 어떤 식별자도 참조하지 않고 있다. 이런 불필요한 값들을 가비지 콜렉터가 자동으로 해제해준다. 단, 언제 해제될지는 예측할 수 없다.

> 프로그래밍 언어는 메모리 관리 방식에 따라 언매니지드 언어와 매니지드 언어로 분류할 수 있다. 
>
> **언매니지드 언어**는 메모리를 직접 할당하고 해제하는 메모리 제어 기능을 제공한다.(C, C++ 등)
>
> **매니지드 언어**는 메모리 할당과 해제를 위한 메모리 관리 기능을 언어 차원에서 담당하고 개발자가 직접적으로 메모리 제어를 할 수 없다.(자바, 자바스크립트 등)

## 4.7 식별자 네이밍 규칙

- 특수문자를 제외한 문자, 숫자, 언더스코어(`_`), 달러 기호(`$`) 사용가능
- 숫자로 시작 불가
- 예약어 사용 불가

### 네이밍 컨벤션(Naming Convention)

가동성을 위해 규정한 명명 규칙이다. 반드시 따를 필요는 없지만 잘 지키면 읽기 편하다.

- 변수, 함수 : 카멜 케이스
- 생성자 함수, 클래스 : 파스칼 케이스

```js
var thisIsCamelCase;

class ThisIsPascalCase{
    // ...
}
```

> 파이썬에서는 변수, 함수 이름으로 스네이크 케이스를 사용한다.
>
> i_am_snake_case = "hello"

---

> 이웅모 저자의 <모던 자바스크립트 Deep Dive> 책으로 스터디 하면서 공부한 내용들을 요약 정리해서 올리는 글입니다. 더 자세한 내용이 궁금하신 분들은 책을 봐주세요.